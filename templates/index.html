<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="static/styles.css" />
    <title>QR Code PDF Generator</title>
</head>
<body>
    <h1>Generate PDF with QR Codes</h1>
    <form id="uploadForm" action="/generate_pdf" method="POST">
        <label for="inputfolder">Input Folder:</label>
        <input type="file" id="inputfolder" webkitdirectory directory multiple>
        <br>
        
        <label for="outputfolder">Output Folder:</label>
        <input type="text" id="outputfolder" name="outputfolder">
        <br>
        
        <label for="titlepage">Title Page:</label>
        <input type="text" id="titlepage" name="titlepage">
        <br>

        <label for="outputfile">Output File Name:</label>
        <input type="text" id="outputfile" name="outputfile">
        <br>

        <button type="submit">Submit</button>
    </form>

    {% if message %}
    <p>{{ message }}</p>
    {% endif %}

    <script>
        document.getElementById('uploadForm').addEventListener('submit', function(event) {
            const inputFolder = document.getElementById('inputfolder');
            const files = inputFolder.files;
            const formData = new FormData();

            let filePaths = [];
            for (let i = 0; i < files.length; i++) {
                filePaths.push(files[i].webkitRelativePath);
            }

            formData.append('inputfolder', JSON.stringify(filePaths));
            formData.append('outputfolder', document.getElementById('outputfolder').value);
            formData.append('titlepage', document.getElementById('titlepage').value);
            formData.append('outputfile', document.getElementById('outputfile').value);

            fetch('/generate_pdf', {
                method: 'POST',
                body: formData
            }).then(response => response.text())
              .then(data => {
                  document.body.innerHTML = data;
              });

            event.preventDefault();
        });
    </script>
</body>
</html>
